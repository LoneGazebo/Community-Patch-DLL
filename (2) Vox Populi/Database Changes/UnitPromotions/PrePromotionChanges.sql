-- Delete tables we replace later
DELETE FROM UnitPromotions_UnitCombats;
DELETE FROM UnitPromotions_UnitClasses;
DELETE FROM UnitPromotions_Domains;

-- Rank lists put similar promotions together and display them in a stack.
-- Highest RankNumber shows up on top of each stack.
-- Think of them as "PromotionClasses".
-- As usual, some changes will make use of these for simplicity, when possible.

CREATE TEMP TABLE Promotion_RankLists (
	PromotionType TEXT,
	RankListTemp TEXT,
	Rank INTEGER
);

INSERT INTO Promotion_RankLists
VALUES
	-- Trunk promotions
	('PROMOTION_SHOCK_1', 'SHOCK', 1),
	('PROMOTION_SHOCK_2', 'SHOCK', 2),
	('PROMOTION_SHOCK_3', 'SHOCK', 3),
	('PROMOTION_DRILL_1', 'DRILL', 1),
	('PROMOTION_DRILL_2', 'DRILL', 2),
	('PROMOTION_DRILL_3', 'DRILL', 3),
	('PROMOTION_BARRAGE_1', 'BARRAGE', 1),
	('PROMOTION_BARRAGE_2', 'BARRAGE', 2),
	('PROMOTION_BARRAGE_3', 'BARRAGE', 3),
	('PROMOTION_ACCURACY_1', 'ACCURACY', 1),
	('PROMOTION_ACCURACY_2', 'ACCURACY', 2),
	('PROMOTION_ACCURACY_3', 'ACCURACY', 3),
	('PROMOTION_ANTI_TANK', 'TANK_HUNTER', 1), -- not pickable, but leads to Tank Hunter and does the same thing
	('PROMOTION_HELI_AMBUSH_1', 'TANK_HUNTER', 2),
	('PROMOTION_HELI_AMBUSH_2', 'TANK_HUNTER', 3),
	('PROMOTION_HELI_MOBILITY_1', 'HELI_MOBILITY', 1),
	('PROMOTION_HELI_MOBILITY_2', 'HELI_MOBILITY', 2),
	('PROMOTION_SIEGE_1', 'SIEGE', 1),
	('PROMOTION_SIEGE_2', 'SIEGE', 2),
	('PROMOTION_SIEGE_3', 'SIEGE', 3),
	('PROMOTION_FIELD_1', 'FIELD', 1),
	('PROMOTION_FIELD_2', 'FIELD', 2),
	('PROMOTION_FIELD_3', 'FIELD', 3),
	('PROMOTION_SURVIVALISM_1', 'SURVIVALISM', 1),
	('PROMOTION_SURVIVALISM_2', 'SURVIVALISM', 2),
	('PROMOTION_SURVIVALISM_3', 'SURVIVALISM', 3),
	('PROMOTION_WOODLAND_TRAILBLAZER_1', 'TRAILBLAZER', 1),
	('PROMOTION_WOODLAND_TRAILBLAZER_2', 'TRAILBLAZER', 2),
	('PROMOTION_WOODLAND_TRAILBLAZER_3', 'TRAILBLAZER', 3),
	('PROMOTION_INTERCEPTION_I', 'INTERCEPTOR', 1),
	('PROMOTION_INTERCEPTION_II', 'INTERCEPTOR', 2),
	('PROMOTION_INTERCEPTION_III', 'INTERCEPTOR', 3),
	('PROMOTION_INTERCEPTION_IV', 'INTERCEPTOR', 4),
	('PROMOTION_COASTAL_RAIDER_1', 'HULL', 1),
	('PROMOTION_COASTAL_RAIDER_2', 'HULL', 2),
	('PROMOTION_COASTAL_RAIDER_3', 'HULL', 3),
	('PROMOTION_BOARDING_PARTY_1', 'BOARDING_PARTY', 1),
	('PROMOTION_BOARDING_PARTY_2', 'BOARDING_PARTY', 2),
	('PROMOTION_BOARDING_PARTY_3', 'BOARDING_PARTY', 3),
	('PROMOTION_TARGETING_1', 'TARGETING', 1),
	('PROMOTION_TARGETING_2', 'TARGETING', 2),
	('PROMOTION_TARGETING_3', 'TARGETING', 3),
	('PROMOTION_BOMBARDMENT_1', 'BOMBARDMENT', 1),
	('PROMOTION_BOMBARDMENT_2', 'BOMBARDMENT', 2),
	('PROMOTION_BOMBARDMENT_3', 'BOMBARDMENT', 3),
	('PROMOTION_WOLFPACK_1', 'TORPEDO', 1),
	('PROMOTION_WOLFPACK_2', 'TORPEDO', 2),
	('PROMOTION_WOLFPACK_3', 'TORPEDO', 3),
	('PROMOTION_FLIGHT_DECK_1', 'FLIGHT_DECK', 1),
	('PROMOTION_FLIGHT_DECK_2', 'FLIGHT_DECK', 2),
	('PROMOTION_FLIGHT_DECK_3', 'FLIGHT_DECK', 3),
	('PROMOTION_ARMOR_PLATING_1', 'ARMOR_PLATING', 1),
	('PROMOTION_ARMOR_PLATING_2', 'ARMOR_PLATING', 2),
	('PROMOTION_ARMOR_PLATING_3', 'ARMOR_PLATING', 3),
	('PROMOTION_INTERCEPTION_1', 'ACE_PILOT', 1),
	('PROMOTION_INTERCEPTION_2', 'ACE_PILOT', 2),
	('PROMOTION_INTERCEPTION_3', 'ACE_PILOT', 3),
	('PROMOTION_SORTIE', 'ACE_PILOT', 4),
	('PROMOTION_DOGFIGHTING_1', 'DOGFIGHTING', 1),
	('PROMOTION_DOGFIGHTING_2', 'DOGFIGHTING', 2),
	('PROMOTION_DOGFIGHTING_3', 'DOGFIGHTING', 3),
	('PROMOTION_ANTI_AIR', 'AIR_SUPREMACY', 1),
	('PROMOTION_ANTI_AIR_II', 'AIR_SUPREMACY', 2),
	('PROMOTION_AIR_SIEGE_1', 'AIR_SIEGE', 1),
	('PROMOTION_AIR_SIEGE_2', 'AIR_SIEGE', 2),
	('PROMOTION_AIR_SIEGE_3', 'AIR_SIEGE', 3),
	('PROMOTION_AIR_TARGETING_1', 'AIR_TARGETING', 1),
	('PROMOTION_AIR_TARGETING_2', 'AIR_TARGETING', 2),
	('PROMOTION_AIR_TARGETING_3', 'AIR_TARGETING', 3),
	-- Leaf promotions
	('PROMOTION_COVER_1', 'COVER', 1),
	('PROMOTION_COVER_2', 'COVER', 2),
	('PROMOTION_MEDIC', 'MEDIC', 1),
	('PROMOTION_MEDIC_II', 'MEDIC', 2),
	('PROMOTION_FORMATION_1', 'FORMATION', 1),
	('PROMOTION_FORMATION_2', 'FORMATION', 2),
	('PROMOTION_AMBUSH_1', 'AMBUSH', 1),
	('PROMOTION_AMBUSH_2', 'AMBUSH', 2),
	('PROMOTION_ANTIAIR_LAND_1', 'AIR_DEFENSE', 1),
	('PROMOTION_ANTIAIR_LAND_2', 'AIR_DEFENSE', 2),
	('PROMOTION_ANTIAIR_LAND_3', 'AIR_DEFENSE', 3),
	('PROMOTION_CHARGE', 'CHARGE', 1),
	('PROMOTION_CHARGE_2', 'CHARGE', 2),
	('PROMOTION_SPLASH_1', 'SPLASH', 1),
	('PROMOTION_SPLASH_2', 'SPLASH', 2),
	('PROMOTION_SCOUTING_1', 'SCOUTING', 1),
	('PROMOTION_SCOUTING_2', 'SCOUTING', 2),
	('PROMOTION_NAVIGATOR_1', 'NAVIGATOR', 1),
	('PROMOTION_NAVIGATOR_2', 'NAVIGATOR', 2),
	('PROMOTION_ANTI_SUBMARINE_I', 'DEPTH_CHARGES', 1),
	('PROMOTION_ANTI_SUBMARINE_II', 'DEPTH_CHARGES', 2),
	('PROMOTION_AIR_AMBUSH_1', 'AIR_AMBUSH', 1),
	('PROMOTION_AIR_AMBUSH_2', 'AIR_AMBUSH', 2),
	('PROMOTION_EVASION_I', 'AIR_PENETRATION', 1),
	('PROMOTION_EVASION_II', 'AIR_PENETRATION', 2),
	('PROMOTION_MARCH', 'MARCH', 1),
	('PROMOTION_SKIRMISHER_MARCH', 'MARCH', 2),
	('PROMOTION_AIR_REPAIR', 'MARCH', 3),
	('PROMOTION_SENTRY', 'SENTRY', 1),
	('PROMOTION_SKIRMISHER_SENTRY', 'SENTRY', 2),
	-- Unique promotions
	('PROMOTION_IKLWA', 'BUFFALO', 1),
	('PROMOTION_BUFFALO_CHEST', 'BUFFALO', 2),
	('PROMOTION_BUFFALO_HORNS', 'BUFFALO', 3),
	('PROMOTION_BUFFALO_LOINS', 'BUFFALO', 4),
	('PROMOTION_RIGHTEOUSNESS', 'BUSHIDO', 1),
	('PROMOTION_COURAGE', 'BUSHIDO', 2),
	('PROMOTION_BENEVOLENCE', 'BUSHIDO', 3),
	('PROMOTION_RESPECT', 'BUSHIDO', 4),
	('PROMOTION_SINCERITY', 'BUSHIDO', 5),
	('PROMOTION_BUSHIDO_HONOR', 'BUSHIDO', 6),
	('PROMOTION_LOYALTY', 'BUSHIDO', 7),
	('PROMOTION_SELF_CONTROL', 'BUSHIDO', 8),
	('PROMOTION_INVULNERABIILITY', 'MYSTIC_BLADE', 1),
	('PROMOTION_SNEAK_ATTACK', 'MYSTIC_BLADE', 2),
	('PROMOTION_AMBITION', 'MYSTIC_BLADE', 3),
	('PROMOTION_RESTLESSNESS', 'MYSTIC_BLADE', 4),
	('PROMOTION_ENEMY_BLADE', 'MYSTIC_BLADE', 5),
	('PROMOTION_EVIL_SPIRITS', 'MYSTIC_BLADE', 6),
	-- Unpickable promotions
	('PROMOTION_FIELD_WORKS_0', 'FIELD_WORKS', 1),
	('PROMOTION_FIELD_WORKS_1', 'FIELD_WORKS', 2),
	('PROMOTION_FIELD_WORKS_2', 'FIELD_WORKS', 3),
	('PROMOTION_FIELD_WORKS_3', 'FIELD_WORKS', 4),
	('PROMOTION_COVERING_FIRE_1', 'COVERING_FIRE', 1),
	('PROMOTION_COVERING_FIRE_2', 'COVERING_FIRE', 2),
	('PROMOTION_MUST_SET_UP', 'SIEGE_ENGINE', 1), -- hide these siege only promotions
	('PROMOTION_SIEGE_INACCURACY', 'SIEGE_ENGINE', 2), -- hide these siege only promotions
	('PROMOTION_CITY_SIEGE', 'SIEGE_ENGINE', 3),
	('PROMOTION_PARADROP', 'PARADROP', 1),
	('PROMOTION_EXTENDED_PARADROP', 'PARADROP', 2),
	('PROMOTION_INVISIBLE_SUBMARINE', 'SUBMARINE_BASE', 1), -- group these submarine starting promotions
	('PROMOTION_CAN_MOVE_IMPASSABLE', 'SUBMARINE_BASE', 2),
	('PROMOTION_BIG_CITY_PENALTY', 'SUBMARINE_BASE', 3),
	('PROMOTION_SILENT_HUNTER', 'SUBMARINE_BASE', 4),
	('PROMOTION_AIR_RECON', 'AIR_RECON', 1),
	('PROMOTION_RECON_RANGE_1', 'AIR_RECON', 2),
	('PROMOTION_RECON_RANGE_2', 'AIR_RECON', 3),
	('PROMOTION_KILL_HEAL', 'AUTHORITY', 1),
	('PROMOTION_HONOR_BONUS', 'AUTHORITY', 2),
	('PROMOTION_NAVAL_TRADITION', 'IMPERIALISM', 1),
	('PROMOTION_IMPERIALISM_OPENER', 'IMPERIALISM', 2),
	('PROMOTION_BETTER_LEADERSHIP', 'IMPERIALISM', 3),
	('PROMOTION_NAVAL_DEFENSE_BOOST', 'IMPERIALISM', 4),
	('PROMOTION_CARGO_I', 'CARGO', 1),
	('PROMOTION_CARGO_II', 'CARGO', 2),
	('PROMOTION_CARGO_III', 'CARGO', 3),
	('PROMOTION_CARGO_IV', 'CARGO', 4),
	('PROMOTION_FASTER_GENERAL', 'GENERAL_MOVEMENT', 1),
	('PROMOTION_FAST_GENERAL', 'GENERAL_MOVEMENT', 2),
	('PROMOTION_SPAWN_GENERALS_I', 'GENERAL_RATE', 1),
	('PROMOTION_SPAWN_GENERALS_II', 'GENERAL_RATE', 2),
	('PROMOTION_WITHDRAW_BEFORE_MELEE', 'WITHDRAW', 1),
	('PROMOTION_COMMANDO', 'WITHDRAW', 2),
	('PROMOTION_FALLOUT_REDUCTION', 'FALLOUT_RESISTANCE', 1),
	('PROMOTION_FALLOUT_IMMUNITY', 'FALLOUT_RESISTANCE', 2),
	('PROMOTION_EMBARKATION', 'EMBARKATION', 1),
	('PROMOTION_DEFENSIVE_EMBARKATION', 'EMBARKATION', 2),
	('PROMOTION_OCEAN_CROSSING', 'EMBARKATION', 3),
	('PROMOTION_ALLWATER_EMBARKATION', 'EMBARKATION', 4),
	('PROMOTION_EMISSARY', 'DIPLO_BASE', 1),
	('PROMOTION_ENVOY', 'DIPLO_BASE', 2),
	('PROMOTION_DIPLOMAT', 'DIPLO_BASE', 3),
	('PROMOTION_AMBASSADOR', 'DIPLO_BASE', 4),
	('PROMOTION_PAX', 'DIPLO_BOOST', 1),
	('PROMOTION_SIGNET', 'DIPLO_BOOST', 2),
	('PROMOTION_EXPRESS', 'DIPLO_BOOST', 3),
	('PROMOTION_LITERACY', 'DIPLO_BOOST', 4),
	('PROMOTION_IMMUNITY', 'DIPLO_BOOST', 5),
	('PROMOTION_NOBILITY', 'DIPLO_BOOST', 6),
	-- Plagues
	('PROMOTION_BOARDED_1', 'BOARDED', 1),
	('PROMOTION_BOARDED_2', 'BOARDED', 2);

UPDATE UnitPromotions
SET
	RankList = (SELECT RankListTemp FROM Promotion_RankLists WHERE PromotionType = Type),
	RankNumber = (SELECT Rank FROM Promotion_RankLists WHERE PromotionType = Type)
WHERE EXISTS (SELECT 1 FROM Promotion_RankLists WHERE PromotionType = Type);

DROP TABLE Promotion_RankLists;
